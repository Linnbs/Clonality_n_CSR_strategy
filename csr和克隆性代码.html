<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bi-Cheng Dong and Yan Lv">
<meta name="dcterms.date" content="2025-05-20">

<title>克隆性和C-S-R策略对外来植物入侵性的影响</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="csr和克隆性代码_files/libs/clipboard/clipboard.min.js"></script>
<script src="csr和克隆性代码_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="csr和克隆性代码_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="csr和克隆性代码_files/libs/quarto-html/popper.min.js"></script>
<script src="csr和克隆性代码_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="csr和克隆性代码_files/libs/quarto-html/anchor.min.js"></script>
<link href="csr和克隆性代码_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="csr和克隆性代码_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="csr和克隆性代码_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="csr和克隆性代码_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="csr和克隆性代码_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#简介" id="toc-简介" class="nav-link active" data-scroll-target="#简介">简介</a></li>
  <li><a href="#环境设置与数据导入" id="toc-环境设置与数据导入" class="nav-link" data-scroll-target="#环境设置与数据导入">1. 环境设置与数据导入</a></li>
  <li><a href="#克隆性与csr策略对入侵性的影响" id="toc-克隆性与csr策略对入侵性的影响" class="nav-link" data-scroll-target="#克隆性与csr策略对入侵性的影响">2. 克隆性与CSR策略对入侵性的影响</a>
  <ul class="collapse">
  <li><a href="#对入侵等级的影响-有序逻辑回归" id="toc-对入侵等级的影响-有序逻辑回归" class="nav-link" data-scroll-target="#对入侵等级的影响-有序逻辑回归">2.1 对入侵等级的影响 (有序逻辑回归)</a></li>
  <li><a href="#对入侵范围的影响-类泊松回归" id="toc-对入侵范围的影响-类泊松回归" class="nav-link" data-scroll-target="#对入侵范围的影响-类泊松回归">2.2 对入侵范围的影响 (类泊松回归)</a></li>
  <li><a href="#汇总图" id="toc-汇总图" class="nav-link" data-scroll-target="#汇总图">2.3 汇总图</a></li>
  </ul></li>
  <li><a href="#克隆类型与csr策略对入侵性的影响" id="toc-克隆类型与csr策略对入侵性的影响" class="nav-link" data-scroll-target="#克隆类型与csr策略对入侵性的影响">3. 克隆类型与CSR策略对入侵性的影响</a>
  <ul class="collapse">
  <li><a href="#对入侵等级的影响-有序逻辑回归-1" id="toc-对入侵等级的影响-有序逻辑回归-1" class="nav-link" data-scroll-target="#对入侵等级的影响-有序逻辑回归-1">3.1 对入侵等级的影响 (有序逻辑回归)</a></li>
  <li><a href="#对入侵范围的影响-类泊松回归-1" id="toc-对入侵范围的影响-类泊松回归-1" class="nav-link" data-scroll-target="#对入侵范围的影响-类泊松回归-1">3.2 对入侵范围的影响 (类泊松回归)</a></li>
  <li><a href="#汇总图-1" id="toc-汇总图-1" class="nav-link" data-scroll-target="#汇总图-1">3.3 汇总图</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">克隆性和C-S-R策略对外来植物入侵性的影响</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bi-Cheng Dong and Yan Lv </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="简介" class="level2">
<h2 class="anchored" data-anchor-id="简介">简介</h2>
<p>植物入侵是全球生物多样性丧失和生态系统功能退化的主要驱动因素之一。克隆繁殖作为入侵植物的重要功能性状，其与CSR生活史策略的交互作用对植物入侵过程的影响尚不明确。本研究基于中国外来入侵植物名录信息，结合克隆特性（克隆性、克隆器官类型）与CSR策略量化指标，采用有序逻辑回归模型分析二者对入侵危害等级和分布范围的交互影响。研究纳入96种入侵植物进行克隆性分析，以及43种入侵克隆植物进行克隆器官类型分析。</p>
<p>分析流程包括： 1. <strong>数据准备</strong>: 加载必要的 R 包，导入并清理数据。 2. <strong>克隆性与入侵性分析</strong>: * 分析克隆有无与 CSR 策略对入侵等级的综合影响。 * 分析克隆有无与 CSR 策略对入侵范围的综合影响。 3. <strong>克隆类型与入侵性分析</strong>: * 分析不同克隆类型（地上/地下）与 CSR 策略对入侵等级的综合影响。 * 分析不同克隆类型（地上/地下）与 CSR 策略对入侵范围的综合影响。</p>
<p>每个分析部分都包含数据建模和可视化两个环节。</p>
</section>
<section id="环境设置与数据导入" class="level2">
<h2 class="anchored" data-anchor-id="环境设置与数据导入">1. 环境设置与数据导入</h2>
<p>首先，我们设置工作目录，并加载本次分析所需的 R 包。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置工作目录</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 请注意：通常建议使用相对路径或 RStudio 项目来管理工作目录</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"D:/我的坚果云/克隆性和csr策略"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "D:/我的坚果云/克隆性和csr策略"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查目录是否存在，如果不存在则创建</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"results02"</span>)) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"results02"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"目录 'results02' 已创建</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"目录 'results02' 已存在</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>目录 'results02' 已存在</code></pre>
</div>
</div>
<p>接下来，导入数据集。该数据集包含植物的克隆属性、CSR 策略得分以及入侵信息。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 导入数据</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df00 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"012.iplant_ias_clonality_csr.csv"</span>, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"GB18030"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 212 Columns: 65
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (41): Taxon_orig, Taxon_orig.authority, 中文名, 拉丁名, 科名, 大类, 保护等级, href, ma...
dbl (16): match_similarity, match_edit_distance, wcvp_id, wcvp_accepted_id, ...
lgl  (8): multiple_matches, wcvp_homotypic, genus_hybrid, species_hybrid, in...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df00)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [212 × 65] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Taxon_orig               : chr [1:212] "Pistia stratiotes" "Eichhornia crassipes" "Lolium temulentum" "Spartina alterniflora" ...
 $ Taxon_orig.authority     : chr [1:212] "L." "(Mart.) Solms" "L." "Loisel." ...
 $ 中文名                   : chr [1:212] "大薸" "凤眼蓝" "毒麦" "互花米草" ...
 $ 拉丁名                   : chr [1:212] "Pistia stratiotes" "Eichhornia crassipes" "Lolium temulentum" "Spartina alterniflora" ...
 $ 科名                     : chr [1:212] "天南星科" "雨久花科" "禾本科" "禾本科" ...
 $ 大类                     : chr [1:212] "被子植物" "被子植物" "被子植物" "被子植物" ...
 $ 保护等级                 : chr [1:212] "1 级（恶意入侵" "1 级（恶意入侵" "1 级（恶意入侵" "1 级（恶意入侵" ...
 $ href                     : chr [1:212] "https://www.plantplus.cn/ias/info/7" "https://www.plantplus.cn/ias/info/23" "https://www.plantplus.cn/ias/info/46" "https://www.plantplus.cn/ias/info/51" ...
 $ match_type               : chr [1:212] "Exact (with author)" "Exact (with author)" "Exact (with author)" "Exact (with author)" ...
 $ multiple_matches         : logi [1:212] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ match_similarity         : num [1:212] 1 1 1 1 1 1 1 1 1 1 ...
 $ match_edit_distance      : num [1:212] 0 0 0 0 0 0 0 0 0 0 ...
 $ wcvp_id                  : num [1:212] 156674 242133 422908 443751 443460 ...
 $ wcvp_name                : chr [1:212] "Pistia stratiotes" "Eichhornia crassipes" "Lolium temulentum" "Spartina alterniflora" ...
 $ wcvp_authors             : chr [1:212] "L." "(Mart.) Solms" "L." "Loisel." ...
 $ wcvp_rank                : chr [1:212] "Species" "Species" "Species" "Species" ...
 $ wcvp_status              : chr [1:212] "Accepted" "Synonym" "Accepted" "Synonym" ...
 $ wcvp_homotypic           : logi [1:212] NA TRUE NA TRUE NA NA ...
 $ wcvp_ipni_id             : chr [1:212] "317684-2" "1198589-2" "407516-1" "422425-1" ...
 $ wcvp_accepted_id         : num [1:212] 156674 259467 422908 497662 443460 ...
 $ wcvp_author_edit_distance: num [1:212] 0 0 0 0 0 0 0 0 1 0 ...
 $ wcvp_author_lcs          : num [1:212] 2 13 2 7 10 12 24 2 6 2 ...
 $ resolved_match_type      : chr [1:212] "Exact (with author)" "Exact (with author)" "Exact (with author)" "Exact (with author)" ...
 $ plant_name_id            : num [1:212] 156674 259467 422908 497662 443460 ...
 $ ipni_id                  : chr [1:212] "317684-2" "310928-2" "407516-1" "77144694-1" ...
 $ taxon_rank               : chr [1:212] "Species" "Species" "Species" "Species" ...
 $ taxon_status             : chr [1:212] "Accepted" "Accepted" "Accepted" "Accepted" ...
 $ family                   : chr [1:212] "Araceae" "Pontederiaceae" "Poaceae" "Poaceae" ...
 $ genus_hybrid             : logi [1:212] NA NA NA NA NA NA ...
 $ genus                    : chr [1:212] "Pistia" "Pontederia" "Lolium" "Sporobolus" ...
 $ species_hybrid           : logi [1:212] NA NA NA NA NA NA ...
 $ species                  : chr [1:212] "stratiotes" "crassipes" "temulentum" "alterniflorus" ...
 $ infraspecific_rank       : logi [1:212] NA NA NA NA NA NA ...
 $ infraspecies             : logi [1:212] NA NA NA NA NA NA ...
 $ parenthetical_author     : chr [1:212] NA NA NA "Loisel." ...
 $ primary_author           : chr [1:212] "L." "Mart." "L." "P.M.Peterson &amp; Saarela" ...
 $ publication_author       : chr [1:212] NA NA NA NA ...
 $ place_of_publication     : chr [1:212] "Sp. Pl." "Nov. Gen. Sp. Pl. Bras." "Sp. Pl." "Taxon" ...
 $ volume_and_page          : chr [1:212] ": 963" "1:09" ": 83" "63: 1236" ...
 $ first_published          : num [1:212] -1753 -1823 -1753 -2014 -1805 ...
 $ nomenclatural_remarks    : chr [1:212] NA NA NA NA ...
 $ geographic_area          : chr [1:212] "Tropics &amp; Subtropics" "S. Trop. America" "Macaronesia, N. Africa, Temp. Eurasia" "E. Canada to E. Mexico, Lesser Antilles to Argentina" ...
 $ lifeform_description     : chr [1:212] "helophyte" "hydroperennial" "annual" "perennial or rhizomatous geophyte" ...
 $ climate_description      : chr [1:212] "wet tropical" "wet tropical" "subtropical" "temperate" ...
 $ taxon_name               : chr [1:212] "Pistia stratiotes" "Pontederia crassipes" "Lolium temulentum" "Sporobolus alterniflorus" ...
 $ taxon_authors            : chr [1:212] "L." "Mart." "L." "(Loisel.) P.M.Peterson &amp; Saarela" ...
 $ accepted_plant_name_id   : num [1:212] 156674 259467 422908 497662 443460 ...
 $ basionym_plant_name_id   : num [1:212] NA NA NA 443751 419044 ...
 $ replaced_synonym_author  : chr [1:212] NA NA NA NA ...
 $ homotypic_synonym        : logi [1:212] NA NA NA NA NA NA ...
 $ parent_plant_name_id     : num [1:212] 156655 259440 422752 443991 443224 ...
 $ powo_id                  : chr [1:212] "317684-2" "310928-2" "407516-1" "77144694-1" ...
 $ hybrid_formula           : logi [1:212] NA NA NA NA NA NA ...
 $ reviewed                 : chr [1:212] "Y" "Y" "Y" "Y" ...
 $ accepted_status          : chr [1:212] "Matched to an accepted name" "Matched to an accepted name" "Matched to an accepted name" "Matched to an accepted name" ...
 $ clonality                : chr [1:212] "clonal" "clonal" "clonal" "clonal" ...
 $ clonal_means             : chr [1:212] "Stolon" "Stolon" "Tiller" "Rhizome/Tiller" ...
 $ clonal_type              : chr [1:212] "aboveground" "aboveground" "aboveground" "both" ...
 $ source                   : chr [1:212] "Xu &amp; Qiang, 2011" "Xu &amp; Qiang, 2011" "CLO-PLA3" "Xu &amp; Qiang, 2011" ...
 $ refs                     : chr [1:212] "wang et al. 2016" "wang et al. 2016" "wang et al. 2016" "wang et al. 2016" ...
 $ c_score                  : num [1:212] NA NA 33.4 NA 50.7 ...
 $ s_score                  : num [1:212] NA NA 25.7 NA 27.8 ...
 $ r_score                  : num [1:212] NA NA 40.9 NA 21.5 ...
 $ n.prov                   : num [1:212] 22 32 30 13 26 9 27 34 25 NA ...
 $ invasion_level           : num [1:212] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "spec")=
  .. cols(
  ..   Taxon_orig = col_character(),
  ..   Taxon_orig.authority = col_character(),
  ..   中文名 = col_character(),
  ..   拉丁名 = col_character(),
  ..   科名 = col_character(),
  ..   大类 = col_character(),
  ..   保护等级 = col_character(),
  ..   href = col_character(),
  ..   match_type = col_character(),
  ..   multiple_matches = col_logical(),
  ..   match_similarity = col_double(),
  ..   match_edit_distance = col_double(),
  ..   wcvp_id = col_double(),
  ..   wcvp_name = col_character(),
  ..   wcvp_authors = col_character(),
  ..   wcvp_rank = col_character(),
  ..   wcvp_status = col_character(),
  ..   wcvp_homotypic = col_logical(),
  ..   wcvp_ipni_id = col_character(),
  ..   wcvp_accepted_id = col_double(),
  ..   wcvp_author_edit_distance = col_double(),
  ..   wcvp_author_lcs = col_double(),
  ..   resolved_match_type = col_character(),
  ..   plant_name_id = col_double(),
  ..   ipni_id = col_character(),
  ..   taxon_rank = col_character(),
  ..   taxon_status = col_character(),
  ..   family = col_character(),
  ..   genus_hybrid = col_logical(),
  ..   genus = col_character(),
  ..   species_hybrid = col_logical(),
  ..   species = col_character(),
  ..   infraspecific_rank = col_logical(),
  ..   infraspecies = col_logical(),
  ..   parenthetical_author = col_character(),
  ..   primary_author = col_character(),
  ..   publication_author = col_character(),
  ..   place_of_publication = col_character(),
  ..   volume_and_page = col_character(),
  ..   first_published = col_double(),
  ..   nomenclatural_remarks = col_character(),
  ..   geographic_area = col_character(),
  ..   lifeform_description = col_character(),
  ..   climate_description = col_character(),
  ..   taxon_name = col_character(),
  ..   taxon_authors = col_character(),
  ..   accepted_plant_name_id = col_double(),
  ..   basionym_plant_name_id = col_double(),
  ..   replaced_synonym_author = col_character(),
  ..   homotypic_synonym = col_logical(),
  ..   parent_plant_name_id = col_double(),
  ..   powo_id = col_character(),
  ..   hybrid_formula = col_logical(),
  ..   reviewed = col_character(),
  ..   accepted_status = col_character(),
  ..   clonality = col_character(),
  ..   clonal_means = col_character(),
  ..   clonal_type = col_character(),
  ..   source = col_character(),
  ..   refs = col_character(),
  ..   c_score = col_double(),
  ..   s_score = col_double(),
  ..   r_score = col_double(),
  ..   n.prov = col_double(),
  ..   invasion_level = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</section>
<section id="克隆性与csr策略对入侵性的影响" class="level2">
<h2 class="anchored" data-anchor-id="克隆性与csr策略对入侵性的影响">2. 克隆性与CSR策略对入侵性的影响</h2>
<p>本部分探究克隆与否 (<code>clonality</code>) 及 CSR 策略得分 (<code>c_score</code>, <code>s_score</code>, <code>r_score</code>) 如何共同影响入侵等级和入侵范围。</p>
<section id="对入侵等级的影响-有序逻辑回归" class="level3">
<h3 class="anchored" data-anchor-id="对入侵等级的影响-有序逻辑回归">2.1 对入侵等级的影响 (有序逻辑回归)</h3>
<section id="数据处理与模型拟合" class="level4">
<h4 class="anchored" data-anchor-id="数据处理与模型拟合">数据处理与模型拟合</h4>
<p>我们首先筛选数据，将入侵等级 (<code>invasion_level</code>) 和克隆性 (<code>clonality</code>) 转换为因子类型，为有序逻辑回归做准备。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取相关数据, 调整分布数据NA为0</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df00 <span class="ot">&lt;-</span> df00 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">n.prov =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(n.prov), <span class="dv">0</span>, n.prov))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 去除缺失数据</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>df01 <span class="ot">&lt;-</span> df00 <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(clonality) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(c_score) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n.prov))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 将 invasion_level 设置为有序因子</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df01<span class="sc">$</span>invasion_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(df01<span class="sc">$</span>invasion_level, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>df01<span class="sc">$</span>clonality <span class="ot">&lt;-</span> <span class="fu">factor</span>(df01<span class="sc">$</span>clonality, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"non-clonal"</span>, <span class="st">"clonal"</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查分类变量的分布</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df01<span class="sc">$</span>invasion_level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 4  3  2  1 
34 17 29 16 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 clm 进行有序逻辑回归</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fit01.ias.level.c <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonality <span class="sc">+</span> c_score <span class="sc">+</span> clonality<span class="sc">:</span>c_score, <span class="at">data =</span> df01, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>fit01.ias.level.s <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonality <span class="sc">+</span> s_score <span class="sc">+</span> clonality<span class="sc">:</span>s_score, <span class="at">data =</span> df01, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>fit01.ias.level.r <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonality <span class="sc">+</span> r_score <span class="sc">+</span> clonality<span class="sc">:</span>r_score, <span class="at">data =</span> df01, <span class="at">link =</span> <span class="st">"logit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>查看并整理模型结果。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.level.c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: invasion_level ~ clonality + c_score + clonality:c_score
data:    df01

 link  threshold nobs logLik  AIC    niter max.grad cond.H 
 logit flexible  96   -123.56 259.11 5(0)  4.20e-12 8.9e+04

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)  
clonalityclonal         -0.19151    0.75018  -0.255   0.7985  
c_score                  0.01949    0.01026   1.899   0.0575 .
clonalityclonal:c_score  0.01086    0.01669   0.651   0.5149  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
    Estimate Std. Error z value
4|3   0.2209     0.5396   0.409
3|2   1.0001     0.5504   1.817
2|1   2.5568     0.5926   4.314</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.level.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: invasion_level ~ clonality + s_score + clonality:s_score
data:    df01

 link  threshold nobs logLik  AIC    niter max.grad cond.H 
 logit flexible  96   -127.69 267.37 5(0)  3.80e-11 1.8e+04

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)
clonalityclonal         -0.3573043  0.5403097  -0.661    0.508
s_score                  0.0009019  0.0128902   0.070    0.944
clonalityclonal:s_score  0.0100280  0.0178135   0.563    0.573

Threshold coefficients:
    Estimate Std. Error z value
4|3  -0.6308     0.3407  -1.851
3|2   0.1071     0.3337   0.321
2|1   1.6018     0.3806   4.209</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.level.r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: invasion_level ~ clonality + r_score + clonality:r_score
data:    df01

 link  threshold nobs logLik  AIC    niter max.grad cond.H 
 logit flexible  96   -122.45 256.91 5(0)  2.03e-13 6.8e+04

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)  
clonalityclonal          0.237554   0.687614   0.345   0.7297  
r_score                 -0.021865   0.010780  -2.028   0.0425 *
clonalityclonal:r_score -0.006879   0.015343  -0.448   0.6539  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
    Estimate Std. Error z value
4|3  -1.5256     0.4995  -3.054
3|2  -0.7107     0.4751  -1.496
2|1   0.8619     0.4988   1.728</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.level.c) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.level.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.level.s) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.level.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.level.r) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.level.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.level.c,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.level.s,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.level.r</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果保存到CSV文件</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit01.ias.level, "./results02/results_fit01.ias.level.csv")</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit01.ias.level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  term                    estimate std.error statistic p.value coef.type model  
  &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  
1 4|3                        0.221     0.54      0.409   0.682 intercept fit01.…
2 3|2                        1         0.55      1.82    0.069 intercept fit01.…
3 2|1                        2.56      0.593     4.31    0     intercept fit01.…
4 clonalityclonal           -0.192     0.75     -0.255   0.799 location  fit01.…
5 c_score                    0.019     0.01      1.90    0.058 location  fit01.…
6 clonalityclonal:c_score    0.011     0.017     0.651   0.515 location  fit01.…</code></pre>
</div>
</div>
</section>
<section id="可视化" class="level4">
<h4 class="anchored" data-anchor-id="可视化">可视化</h4>
<p>使用箱线图展示不同克隆性、不同 CSR 策略得分下入侵等级的分布。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换数据为长格式以方便作图</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df01_long <span class="ot">&lt;-</span> df01 <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(c_score, s_score, r_score),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"score_type"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score_value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义分面标题</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>score_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c_score"</span> <span class="ot">=</span> <span class="st">"C-score"</span>, <span class="st">"r_score"</span> <span class="ot">=</span> <span class="st">"R-score"</span>, <span class="st">"s_score"</span> <span class="ot">=</span> <span class="st">"S-score"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 facet_wrap 绘图</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plot.rank01 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df01_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> invasion_level, <span class="at">fill =</span> clonality)) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"Invasion rankings"</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"non-clonal"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"clonal"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonality:"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.rank01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="csr和克隆性代码_files/figure-html/plot-level-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.rank01,</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#       filename = "./results02/plot.rank01.png",</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 2400,</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 1200,</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       pointsize = 12,</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       res = 300</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="对入侵范围的影响-类泊松回归" class="level3">
<h3 class="anchored" data-anchor-id="对入侵范围的影响-类泊松回归">2.2 对入侵范围的影响 (类泊松回归)</h3>
<section id="数据处理与模型拟合-1" class="level4">
<h4 class="anchored" data-anchor-id="数据处理与模型拟合-1">数据处理与模型拟合</h4>
<p>入侵范围 (<code>n.prov</code>) 是计数数据，我们使用广义线性模型 (GLM) 进行拟合。由于数据可能存在过度离散，我们选择 <code>quasipoisson</code> 分布。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用广义线性模型（GLM）拟合</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist.c <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonality <span class="sc">+</span> c_score <span class="sc">+</span> clonality<span class="sc">:</span>c_score, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist.s <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonality <span class="sc">+</span> s_score <span class="sc">+</span> clonality<span class="sc">:</span>s_score, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist.r <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonality <span class="sc">+</span> r_score <span class="sc">+</span> clonality<span class="sc">:</span>r_score, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>查看并整理模型结果。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.dist.c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n.prov ~ clonality + c_score + clonality:c_score, 
    family = quasipoisson(link = "log"), data = df01)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.8750  -4.8652   0.1737   2.1974   4.6550  

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              3.218413   0.192563  16.714   &lt;2e-16 ***
clonalityclonal         -0.800250   0.319486  -2.505   0.0140 *  
c_score                 -0.007294   0.004192  -1.740   0.0852 .  
clonalityclonal:c_score  0.011210   0.007355   1.524   0.1309    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 9.636597)

    Null deviance: 1291.0  on 95  degrees of freedom
Residual deviance: 1210.4  on 92  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.dist.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n.prov ~ clonality + s_score + clonality:s_score, 
    family = quasipoisson(link = "log"), data = df01)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.5187  -5.0089   0.4556   2.4573   4.6825  

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              3.056216   0.128929  23.705   &lt;2e-16 ***
clonalityclonal         -0.456042   0.239434  -1.905   0.0599 .  
s_score                 -0.009599   0.006164  -1.557   0.1229    
clonalityclonal:s_score  0.007792   0.008822   0.883   0.3794    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 9.76702)

    Null deviance: 1291.0  on 95  degrees of freedom
Residual deviance: 1217.4  on 92  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.dist.r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n.prov ~ clonality + r_score + clonality:r_score, 
    family = quasipoisson(link = "log"), data = df01)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.0502  -4.9696   0.2217   2.4203   4.5845  

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              2.407852   0.209547  11.491   &lt;2e-16 ***
clonalityclonal          0.209862   0.320265   0.655   0.5139    
r_score                  0.011592   0.003903   2.970   0.0038 ** 
clonalityclonal:r_score -0.013123   0.006437  -2.039   0.0443 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 9.470956)

    Null deviance: 1291.0  on 95  degrees of freedom
Residual deviance: 1162.4  on 92  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.dist.c) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.dist.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.dist.s) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.dist.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.dist.r) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.dist.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.dist.c,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.dist.s,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.dist.r</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果保存到CSV文件</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit01.ias.dist, "./results02/results_fit01.ias.dist.csv")</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit01.ias.dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  term                    estimate std.error statistic p.value model           
  &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;           
1 (Intercept)                3.22      0.193     16.7    0     fit01.ias.dist.c
2 clonalityclonal           -0.8       0.319     -2.50   0.014 fit01.ias.dist.c
3 c_score                   -0.007     0.004     -1.74   0.085 fit01.ias.dist.c
4 clonalityclonal:c_score    0.011     0.007      1.52   0.131 fit01.ias.dist.c
5 (Intercept)                3.06      0.129     23.7    0     fit01.ias.dist.s
6 clonalityclonal           -0.456     0.239     -1.90   0.06  fit01.ias.dist.s</code></pre>
</div>
</div>
</section>
<section id="可视化-1" class="level4">
<h4 class="anchored" data-anchor-id="可视化-1">可视化</h4>
<p>为了可视化模型结果，我们生成预测数据，并在散点图上绘制拟合曲线。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义评分变量和类型</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>score_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>score_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">21</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用map批量拟合模型并生成预测数据</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist <span class="ot">&lt;-</span> <span class="fu">map</span>(score_types, <span class="cf">function</span>(var) {</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"n.prov ~ clonality +"</span>, var, <span class="st">"+ clonality:"</span>, var))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(formula, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fit01.ias.dist) <span class="ot">&lt;-</span> score_types</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>pred01_list <span class="ot">&lt;-</span> <span class="fu">map2</span>(score_types, fit01.ias.dist, <span class="cf">function</span>(var_name, model) {</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  var_grid <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">list</span>(score_seq, <span class="fu">unique</span>(df01<span class="sc">$</span>clonality)), <span class="fu">c</span>(var_name, <span class="st">"clonality"</span>))</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  new_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(expand.grid, var_grid)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>n.prov <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_type <span class="ot">&lt;-</span> var_name</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_value <span class="ot">&lt;-</span> new_data[[var_name]]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  new_data[[var_name]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new_data)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>pred01_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pred01_list) <span class="sc">%&gt;%</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(score_type, clonality, score_value) <span class="sc">%&gt;%</span> </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>plot.dist01 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df01_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov, <span class="at">color =</span> clonality)) <span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred01_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"No. provinces"</span>) <span class="sc">+</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"non-clonal"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"clonal"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonality:"</span>,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.dist01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="csr和克隆性代码_files/figure-html/plot-dist-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.dist01,</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          filename = "./results02/plot.dist01.png",</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          width = 2400,</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          height = 1200,</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          pointsize = 12,</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#          res = 300</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="汇总图" class="level3">
<h3 class="anchored" data-anchor-id="汇总图">2.3 汇总图</h3>
<p>将入侵等级和入侵范围的图合并展示。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总图</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plot01 <span class="ot">&lt;-</span> plot.rank01 <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>          plot.dist01 <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="csr和克隆性代码_files/figure-html/plot-summary-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存汇总图</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot01,</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          filename = "./results02/plot01.png",</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          width = 2400,</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          height = 2400,</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          pointsize = 12,</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#          res = 300</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
<section id="克隆类型与csr策略对入侵性的影响" class="level2">
<h2 class="anchored" data-anchor-id="克隆类型与csr策略对入侵性的影响">3. 克隆类型与CSR策略对入侵性的影响</h2>
<p>本部分进一步细分克隆植物，探究不同克隆类型 (<code>clonal_type</code>: 地上/地下) 与 CSR 策略如何影响入侵性。</p>
<section id="对入侵等级的影响-有序逻辑回归-1" class="level3">
<h3 class="anchored" data-anchor-id="对入侵等级的影响-有序逻辑回归-1">3.1 对入侵等级的影响 (有序逻辑回归)</h3>
<section id="数据处理与模型拟合-2" class="level4">
<h4 class="anchored" data-anchor-id="数据处理与模型拟合-2">数据处理与模型拟合</h4>
<p>筛选出具有明确地上或地下克隆器官的物种，并构建有序逻辑回归模型。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 筛选有效数据</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df02 <span class="ot">&lt;-</span> df00 <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clonal_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"aboveground"</span>, <span class="st">"belowground"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(clonal_type) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(c_score) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n.prov))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df02<span class="sc">$</span>clonal_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
aboveground belowground 
         19          19 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 将变量设置为因子</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df02<span class="sc">$</span>invasion_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(df02<span class="sc">$</span>invasion_level, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df02<span class="sc">$</span>clonal_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df02<span class="sc">$</span>clonal_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"aboveground"</span>, <span class="st">"belowground"</span>))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型拟合</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>fit02.ias.level.c <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonal_type <span class="sc">+</span> c_score <span class="sc">+</span> clonal_type<span class="sc">:</span>c_score, <span class="at">data =</span> df02, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>fit02.ias.level.s <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonal_type <span class="sc">+</span> s_score <span class="sc">+</span> clonal_type<span class="sc">:</span>s_score, <span class="at">data =</span> df02, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>fit02.ias.level.r <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonal_type <span class="sc">+</span> r_score <span class="sc">+</span> clonal_type<span class="sc">:</span>r_score, <span class="at">data =</span> df02, <span class="at">link =</span> <span class="st">"logit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>查看并整理模型结果。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.level.c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: invasion_level ~ clonal_type + c_score + clonal_type:c_score
data:    df02

 link  threshold nobs logLik AIC    niter max.grad cond.H 
 logit flexible  38   -48.57 109.14 4(0)  2.23e-09 7.5e+04

Coefficients:
                                Estimate Std. Error z value Pr(&gt;|z|)
clonal_typebelowground         -1.006408   1.243485  -0.809    0.418
c_score                         0.033998   0.025853   1.315    0.188
clonal_typebelowground:c_score  0.005721   0.031899   0.179    0.858

Threshold coefficients:
    Estimate Std. Error z value
4|3  0.06879    0.73666   0.093
3|2  1.03910    0.74333   1.398
2|1  2.45955    0.84714   2.903</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.level.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: invasion_level ~ clonal_type + s_score + clonal_type:s_score
data:    df02

 link  threshold nobs logLik AIC    niter max.grad cond.H 
 logit flexible  38   -50.96 113.91 4(0)  1.01e-09 2.8e+04

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)
clonal_typebelowground          0.62514    0.94424   0.662    0.508
s_score                         0.01801    0.01593   1.130    0.258
clonal_typebelowground:s_score -0.01797    0.03162  -0.568    0.570

Threshold coefficients:
    Estimate Std. Error z value
4|3  -0.0843     0.6559  -0.129
3|2   0.8183     0.6724   1.217
2|1   2.1242     0.7477   2.841</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.level.r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>formula: invasion_level ~ clonal_type + r_score + clonal_type:r_score
data:    df02

 link  threshold nobs logLik AIC    niter max.grad cond.H 
 logit flexible  38   -47.72 107.44 4(0)  4.82e-09 6.5e+04

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)  
clonal_typebelowground          0.25539    1.11277   0.230   0.8185  
r_score                        -0.02733    0.01523  -1.794   0.0728 .
clonal_typebelowground:r_score -0.01600    0.02664  -0.600   0.5482  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
    Estimate Std. Error z value
4|3  -1.9998     0.8525  -2.346
3|2  -0.9602     0.7879  -1.219
2|1   0.4864     0.7871   0.618</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.level.c) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.level.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.level.s) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.level.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.level.r) <span class="sc">%&gt;%</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.level.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.level.c,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.level.s,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.level.r</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存结果</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit02.ias.level, "./results02/results_fit02.ias.level.csv")</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit02.ias.level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  term                      estimate std.error statistic p.value coef.type model
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;
1 4|3                          0.069     0.737     0.093   0.926 intercept fit0…
2 3|2                          1.04      0.743     1.40    0.162 intercept fit0…
3 2|1                          2.46      0.847     2.90    0.004 intercept fit0…
4 clonal_typebelowground      -1.01      1.24     -0.809   0.418 location  fit0…
5 c_score                      0.034     0.026     1.32    0.188 location  fit0…
6 clonal_typebelowground:c…    0.006     0.032     0.179   0.858 location  fit0…</code></pre>
</div>
</div>
</section>
<section id="可视化-2" class="level4">
<h4 class="anchored" data-anchor-id="可视化-2">可视化</h4>
<p>使用箱线图展示不同克隆类型、不同 CSR 策略得分下入侵等级的分布。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换数据为长格式</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df02_long <span class="ot">&lt;-</span> df02 <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(c_score, s_score, r_score),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"score_type"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score_value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>plot.rank02 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df02_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> invasion_level, <span class="at">fill =</span> clonal_type)) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"Invasion rankings"</span>) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"aboveground"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"belowground"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonal type:"</span>,</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Aboveground"</span>, <span class="st">"Belowground"</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.rank02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="csr和克隆性代码_files/figure-html/plot-level-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.rank02,</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#       filename = "./results02/plot.rank02.png",</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 2400,</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 1200,</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       pointsize = 12,</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       res = 300</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="对入侵范围的影响-类泊松回归-1" class="level3">
<h3 class="anchored" data-anchor-id="对入侵范围的影响-类泊松回归-1">3.2 对入侵范围的影响 (类泊松回归)</h3>
<section id="数据处理与模型拟合-3" class="level4">
<h4 class="anchored" data-anchor-id="数据处理与模型拟合-3">数据处理与模型拟合</h4>
<p>与上一部分类似，我们使用类泊松回归模型分析克隆类型与 CSR 策略对入侵范围的影响。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型拟合</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist.c <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonal_type <span class="sc">+</span> c_score <span class="sc">+</span> clonal_type<span class="sc">:</span>c_score, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist.s <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonal_type <span class="sc">+</span> s_score <span class="sc">+</span> clonal_type<span class="sc">:</span>s_score, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist.r <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonal_type <span class="sc">+</span> r_score <span class="sc">+</span> clonal_type<span class="sc">:</span>r_score, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>查看并整理模型结果。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.dist.c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n.prov ~ clonal_type + c_score + clonal_type:c_score, 
    family = quasipoisson(link = "log"), data = df02)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.6248  -4.1517  -0.0892   2.9162   4.2441  

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     1.82057    0.42678   4.266  0.00015 ***
clonal_typebelowground          1.18613    0.60968   1.945  0.06002 .  
c_score                         0.02075    0.01104   1.879  0.06879 .  
clonal_typebelowground:c_score -0.02934    0.01447  -2.028  0.05046 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 10.93902)

    Null deviance: 532.83  on 37  degrees of freedom
Residual deviance: 482.26  on 34  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.dist.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n.prov ~ clonal_type + s_score + clonal_type:s_score, 
    family = quasipoisson(link = "log"), data = df02)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.2929  -4.8372  -0.7741   2.8779   5.2237  

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     2.525351   0.358382   7.047  3.9e-08 ***
clonal_typebelowground          0.114244   0.502486   0.227    0.822    
s_score                        -0.003885   0.010013  -0.388    0.700    
clonal_typebelowground:s_score  0.003676   0.016954   0.217    0.830    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 12.00388)

    Null deviance: 532.83  on 37  degrees of freedom
Residual deviance: 525.32  on 34  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.dist.r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n.prov ~ clonal_type + r_score + clonal_type:r_score, 
    family = quasipoisson(link = "log"), data = df02)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.3477  -4.7376  -0.7812   2.8117   4.7440  

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     2.742207   0.437847   6.263 3.93e-07 ***
clonal_typebelowground         -0.388899   0.591190  -0.658    0.515    
r_score                        -0.007549   0.009103  -0.829    0.413    
clonal_typebelowground:r_score  0.015354   0.012636   1.215    0.233    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 11.97407)

    Null deviance: 532.83  on 37  degrees of freedom
Residual deviance: 509.66  on 34  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.dist.c) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.dist.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.dist.s) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.dist.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.dist.r) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.dist.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.dist.c,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.dist.s,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.dist.r</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存结果</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit02.ias.dist, "./results02/results_fit02.ias.dist.csv")</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit02.ias.dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  term                           estimate std.error statistic p.value model     
  &lt;chr&gt;                             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     
1 (Intercept)                       1.82      0.427     4.27    0     fit02.ias…
2 clonal_typebelowground            1.19      0.61      1.94    0.06  fit02.ias…
3 c_score                           0.021     0.011     1.88    0.069 fit02.ias…
4 clonal_typebelowground:c_score   -0.029     0.014    -2.03    0.05  fit02.ias…
5 (Intercept)                       2.52      0.358     7.05    0     fit02.ias…
6 clonal_typebelowground            0.114     0.502     0.227   0.822 fit02.ias…</code></pre>
</div>
</div>
</section>
<section id="可视化-3" class="level4">
<h4 class="anchored" data-anchor-id="可视化-3">可视化</h4>
<p>生成预测数据，并在散点图上绘制不同克隆类型的拟合曲线。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义评分变量和类型</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>score_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>score_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">21</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用map批量拟合模型并生成预测数据</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist <span class="ot">&lt;-</span> <span class="fu">map</span>(score_types, <span class="cf">function</span>(var) {</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"n.prov ~ clonal_type +"</span>, var, <span class="st">"+ clonal_type:"</span>, var))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(formula, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fit02.ias.dist) <span class="ot">&lt;-</span> score_types</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>pred02_list <span class="ot">&lt;-</span> <span class="fu">map2</span>(score_types, fit02.ias.dist, <span class="cf">function</span>(var_name, model) {</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  var_grid <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">list</span>(score_seq, <span class="fu">unique</span>(df02<span class="sc">$</span>clonal_type)), <span class="fu">c</span>(var_name, <span class="st">"clonal_type"</span>))</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  new_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(expand.grid, var_grid)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>n.prov <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_type <span class="ot">&lt;-</span> var_name</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_value <span class="ot">&lt;-</span> new_data[[var_name]]</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  new_data[[var_name]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new_data)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>pred02_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pred02_list) <span class="sc">%&gt;%</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(score_type, clonal_type, score_value) <span class="sc">%&gt;%</span> </span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>plot.dist02 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df02_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov, <span class="at">color =</span> clonal_type)) <span class="sc">+</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred02_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"No. provinces"</span>) <span class="sc">+</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"aboveground"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"belowground"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonal type:"</span>,</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Aboveground"</span>, <span class="st">"Belowground"</span>)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.dist02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="csr和克隆性代码_files/figure-html/plot-dist-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.dist02,</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#       filename = "./results02/plot.dist02.png",</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 2400,</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 1200,</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       pointsize = 12,</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       res = 300</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="汇总图-1" class="level3">
<h3 class="anchored" data-anchor-id="汇总图-1">3.3 汇总图</h3>
<p>将关于克隆类型的入侵等级和入侵范围的图合并展示。</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总图</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>plot02 <span class="ot">&lt;-</span> plot.rank02 <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>          plot.dist02 <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="csr和克隆性代码_files/figure-html/plot-summary-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存汇总图</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot02,</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          filename = "./results02/plot02.png",</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          width = 2400,</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          height = 2400,</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          pointsize = 12,</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co">#          res = 300</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "克隆性和C-S-R策略对外来植物入侵性的影响"</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Bi-Cheng Dong and Yan Lv"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-05-20"</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## 简介</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>植物入侵是全球生物多样性丧失和生态系统功能退化的主要驱动因素之一。克隆繁殖作为入侵植物的重要功能性状，其与CSR生活史策略的交互作用对植物入侵过程的影响尚不明确。本研究基于中国外来入侵植物名录信息，结合克隆特性（克隆性、克隆器官类型）与CSR策略量化指标，采用有序逻辑回归模型分析二者对入侵危害等级和分布范围的交互影响。研究纳入96种入侵植物进行克隆性分析，以及43种入侵克隆植物进行克隆器官类型分析。</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>分析流程包括： 1. **数据准备**: 加载必要的 R 包，导入并清理数据。 2. **克隆性与入侵性分析**: \* 分析克隆有无与 CSR 策略对入侵等级的综合影响。 \* 分析克隆有无与 CSR 策略对入侵范围的综合影响。 3. **克隆类型与入侵性分析**: <span class="sc">\*</span> 分析不同克隆类型（地上/地下）与 CSR 策略对入侵等级的综合影响。 <span class="sc">\*</span> 分析不同克隆类型（地上/地下）与 CSR 策略对入侵范围的综合影响。</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>每个分析部分都包含数据建模和可视化两个环节。</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. 环境设置与数据导入</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>首先，我们设置工作目录，并加载本次分析所需的 R 包。</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, message=FALSE, warning=FALSE}</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置工作目录</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 请注意：通常建议使用相对路径或 RStudio 项目来管理工作目录</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"D:/我的坚果云/克隆性和csr策略"</span>)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查目录是否存在，如果不存在则创建</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"results02"</span>)) {</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"results02"</span>)</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"目录 'results02' 已创建</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"目录 'results02' 已存在</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>接下来，导入数据集。该数据集包含植物的克隆属性、CSR 策略得分以及入侵信息。</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-data}</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 导入数据</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>df00 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"012.iplant_ias_clonality_csr.csv"</span>, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"GB18030"</span>))</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df00)</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. 克隆性与CSR策略对入侵性的影响</span></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>本部分探究克隆与否 (<span class="in">`clonality`</span>) 及 CSR 策略得分 (<span class="in">`c_score`</span>, <span class="in">`s_score`</span>, <span class="in">`r_score`</span>) 如何共同影响入侵等级和入侵范围。</span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 对入侵等级的影响 (有序逻辑回归)</span></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 数据处理与模型拟合</span></span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>我们首先筛选数据，将入侵等级 (<span class="in">`invasion_level`</span>) 和克隆性 (<span class="in">`clonality`</span>) 转换为因子类型，为有序逻辑回归做准备。</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r analysis-level-1}</span></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取相关数据, 调整分布数据NA为0</span></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>df00 <span class="ot">&lt;-</span> df00 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">n.prov =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(n.prov), <span class="dv">0</span>, n.prov))</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a><span class="co"># 去除缺失数据</span></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>df01 <span class="ot">&lt;-</span> df00 <span class="sc">%&gt;%</span></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(clonality) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(c_score) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n.prov))</span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a><span class="co"># 将 invasion_level 设置为有序因子</span></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a>df01<span class="sc">$</span>invasion_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(df01<span class="sc">$</span>invasion_level, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>df01<span class="sc">$</span>clonality <span class="ot">&lt;-</span> <span class="fu">factor</span>(df01<span class="sc">$</span>clonality, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"non-clonal"</span>, <span class="st">"clonal"</span>))</span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查分类变量的分布</span></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df01<span class="sc">$</span>invasion_level)</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 clm 进行有序逻辑回归</span></span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a>fit01.ias.level.c <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonality <span class="sc">+</span> c_score <span class="sc">+</span> clonality<span class="sc">:</span>c_score, <span class="at">data =</span> df01, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a>fit01.ias.level.s <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonality <span class="sc">+</span> s_score <span class="sc">+</span> clonality<span class="sc">:</span>s_score, <span class="at">data =</span> df01, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a>fit01.ias.level.r <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonality <span class="sc">+</span> r_score <span class="sc">+</span> clonality<span class="sc">:</span>r_score, <span class="at">data =</span> df01, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a>查看并整理模型结果。</span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary-level-1}</span></span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb68-98"><a href="#cb68-98" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.level.c)</span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.level.s)</span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.level.r)</span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.level.c) <span class="sc">%&gt;%</span></span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.level.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.level.s) <span class="sc">%&gt;%</span></span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.level.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.level.r) <span class="sc">%&gt;%</span></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.level.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.level <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.level.c,</span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.level.s,</span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.level.r</span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果保存到CSV文件</span></span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit01.ias.level, "./results02/results_fit01.ias.level.csv")</span></span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit01.ias.level)</span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 可视化</span></span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a>使用箱线图展示不同克隆性、不同 CSR 策略得分下入侵等级的分布。</span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-level-1}</span></span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换数据为长格式以方便作图</span></span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a>df01_long <span class="ot">&lt;-</span> df01 <span class="sc">%&gt;%</span></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(c_score, s_score, r_score),</span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"score_type"</span>,</span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score_value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义分面标题</span></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a>score_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c_score"</span> <span class="ot">=</span> <span class="st">"C-score"</span>, <span class="st">"r_score"</span> <span class="ot">=</span> <span class="st">"R-score"</span>, <span class="st">"s_score"</span> <span class="ot">=</span> <span class="st">"S-score"</span>)</span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 facet_wrap 绘图</span></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a>plot.rank01 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df01_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> invasion_level, <span class="at">fill =</span> clonality)) <span class="sc">+</span></span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"Invasion rankings"</span>) <span class="sc">+</span></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"non-clonal"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"clonal"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonality:"</span>,</span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.rank01)</span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.rank01,</span></span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a><span class="co">#       filename = "./results02/plot.rank01.png",</span></span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 2400,</span></span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 1200,</span></span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a><span class="co">#       pointsize = 12,</span></span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a><span class="co">#       res = 300</span></span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2 对入侵范围的影响 (类泊松回归)</span></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 数据处理与模型拟合</span></span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a>入侵范围 (<span class="in">`n.prov`</span>) 是计数数据，我们使用广义线性模型 (GLM) 进行拟合。由于数据可能存在过度离散，我们选择 <span class="in">`quasipoisson`</span> 分布。</span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r analysis-dist-1}</span></span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用广义线性模型（GLM）拟合</span></span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist.c <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonality <span class="sc">+</span> c_score <span class="sc">+</span> clonality<span class="sc">:</span>c_score, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist.s <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonality <span class="sc">+</span> s_score <span class="sc">+</span> clonality<span class="sc">:</span>s_score, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist.r <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonality <span class="sc">+</span> r_score <span class="sc">+</span> clonality<span class="sc">:</span>r_score, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a>查看并整理模型结果。</span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary-dist-1}</span></span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.dist.c)</span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.dist.s)</span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01.ias.dist.r)</span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.dist.c) <span class="sc">%&gt;%</span></span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.dist.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.dist.s) <span class="sc">%&gt;%</span></span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.dist.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit01.ias.dist.r) <span class="sc">%&gt;%</span></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit01.ias.dist.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a>results_fit01.ias.dist <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.dist.c,</span>
<span id="cb68-215"><a href="#cb68-215" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.dist.s,</span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a>    results_fit01.ias.dist.r</span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果保存到CSV文件</span></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit01.ias.dist, "./results02/results_fit01.ias.dist.csv")</span></span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit01.ias.dist)</span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 可视化</span></span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a>为了可视化模型结果，我们生成预测数据，并在散点图上绘制拟合曲线。</span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-dist-1}</span></span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义评分变量和类型</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a>score_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)</span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a>score_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">21</span>)</span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用map批量拟合模型并生成预测数据</span></span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a>fit01.ias.dist <span class="ot">&lt;-</span> <span class="fu">map</span>(score_types, <span class="cf">function</span>(var) {</span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"n.prov ~ clonality +"</span>, var, <span class="st">"+ clonality:"</span>, var))</span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(formula, <span class="at">data =</span> df01, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fit01.ias.dist) <span class="ot">&lt;-</span> score_types</span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a>pred01_list <span class="ot">&lt;-</span> <span class="fu">map2</span>(score_types, fit01.ias.dist, <span class="cf">function</span>(var_name, model) {</span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a>  var_grid <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">list</span>(score_seq, <span class="fu">unique</span>(df01<span class="sc">$</span>clonality)), <span class="fu">c</span>(var_name, <span class="st">"clonality"</span>))</span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a>  new_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(expand.grid, var_grid)</span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>n.prov <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_type <span class="ot">&lt;-</span> var_name</span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_value <span class="ot">&lt;-</span> new_data[[var_name]]</span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a>  new_data[[var_name]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new_data)</span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a>pred01_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pred01_list) <span class="sc">%&gt;%</span></span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(score_type, clonality, score_value) <span class="sc">%&gt;%</span> </span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a>plot.dist01 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df01_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov, <span class="at">color =</span> clonality)) <span class="sc">+</span></span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred01_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"No. provinces"</span>) <span class="sc">+</span></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"non-clonal"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"clonal"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonality:"</span>,</span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.dist01)</span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.dist01,</span></span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a><span class="co">#          filename = "./results02/plot.dist01.png",</span></span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a><span class="co">#          width = 2400,</span></span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a><span class="co">#          height = 1200,</span></span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a><span class="co">#          pointsize = 12,</span></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a><span class="co">#          res = 300</span></span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-292"><a href="#cb68-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3 汇总图</span></span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a>将入侵等级和入侵范围的图合并展示。</span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-summary-1}</span></span>
<span id="cb68-298"><a href="#cb68-298" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总图</span></span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a>plot01 <span class="ot">&lt;-</span> plot.rank01 <span class="sc">+</span></span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a>          plot.dist01 <span class="sc">+</span></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot01)</span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存汇总图</span></span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot01,</span></span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a><span class="co">#          filename = "./results02/plot01.png",</span></span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a><span class="co">#          width = 2400,</span></span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a><span class="co">#          height = 2400,</span></span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a><span class="co">#          pointsize = 12,</span></span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a><span class="co">#          res = 300</span></span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. 克隆类型与CSR策略对入侵性的影响</span></span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a>本部分进一步细分克隆植物，探究不同克隆类型 (<span class="in">`clonal_type`</span>: 地上/地下) 与 CSR 策略如何影响入侵性。</span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 对入侵等级的影响 (有序逻辑回归)</span></span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 数据处理与模型拟合</span></span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a>筛选出具有明确地上或地下克隆器官的物种，并构建有序逻辑回归模型。</span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r analysis-level-2}</span></span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a><span class="co"># 筛选有效数据</span></span>
<span id="cb68-330"><a href="#cb68-330" aria-hidden="true" tabindex="-1"></a>df02 <span class="ot">&lt;-</span> df00 <span class="sc">%&gt;%</span></span>
<span id="cb68-331"><a href="#cb68-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clonal_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"aboveground"</span>, <span class="st">"belowground"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(clonal_type) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(c_score) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n.prov))</span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df02<span class="sc">$</span>clonal_type)</span>
<span id="cb68-335"><a href="#cb68-335" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df02)</span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a><span class="co"># 将变量设置为因子</span></span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a>df02<span class="sc">$</span>invasion_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(df02<span class="sc">$</span>invasion_level, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a>df02<span class="sc">$</span>clonal_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df02<span class="sc">$</span>clonal_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"aboveground"</span>, <span class="st">"belowground"</span>))</span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型拟合</span></span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a>fit02.ias.level.c <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonal_type <span class="sc">+</span> c_score <span class="sc">+</span> clonal_type<span class="sc">:</span>c_score, <span class="at">data =</span> df02, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a>fit02.ias.level.s <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonal_type <span class="sc">+</span> s_score <span class="sc">+</span> clonal_type<span class="sc">:</span>s_score, <span class="at">data =</span> df02, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a>fit02.ias.level.r <span class="ot">&lt;-</span> <span class="fu">clm</span>(invasion_level <span class="sc">~</span> clonal_type <span class="sc">+</span> r_score <span class="sc">+</span> clonal_type<span class="sc">:</span>r_score, <span class="at">data =</span> df02, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a>查看并整理模型结果。</span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary-level-2}</span></span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.level.c)</span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.level.s)</span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.level.r)</span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.level.c) <span class="sc">%&gt;%</span></span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.level.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-360"><a href="#cb68-360" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.level.s) <span class="sc">%&gt;%</span></span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.level.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.level.r) <span class="sc">%&gt;%</span></span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.level.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.level <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.level.c,</span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.level.s,</span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.level.r</span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存结果</span></span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit02.ias.level, "./results02/results_fit02.ias.level.csv")</span></span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit02.ias.level)</span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 可视化</span></span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a>使用箱线图展示不同克隆类型、不同 CSR 策略得分下入侵等级的分布。</span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-level-2}</span></span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换数据为长格式</span></span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a>df02_long <span class="ot">&lt;-</span> df02 <span class="sc">%&gt;%</span></span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(c_score, s_score, r_score),</span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"score_type"</span>,</span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score_value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb68-390"><a href="#cb68-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-391"><a href="#cb68-391" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a>plot.rank02 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df02_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> invasion_level, <span class="at">fill =</span> clonal_type)) <span class="sc">+</span></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"Invasion rankings"</span>) <span class="sc">+</span></span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"aboveground"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"belowground"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonal type:"</span>,</span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Aboveground"</span>, <span class="st">"Belowground"</span>)</span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb68-401"><a href="#cb68-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb68-402"><a href="#cb68-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-409"><a href="#cb68-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb68-410"><a href="#cb68-410" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.rank02)</span>
<span id="cb68-418"><a href="#cb68-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.rank02,</span></span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a><span class="co">#       filename = "./results02/plot.rank02.png",</span></span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 2400,</span></span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 1200,</span></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a><span class="co">#       pointsize = 12,</span></span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a><span class="co">#       res = 300</span></span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 对入侵范围的影响 (类泊松回归)</span></span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 数据处理与模型拟合</span></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a>与上一部分类似，我们使用类泊松回归模型分析克隆类型与 CSR 策略对入侵范围的影响。</span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r analysis-dist-2}</span></span>
<span id="cb68-436"><a href="#cb68-436" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型拟合</span></span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist.c <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonal_type <span class="sc">+</span> c_score <span class="sc">+</span> clonal_type<span class="sc">:</span>c_score, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist.s <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonal_type <span class="sc">+</span> s_score <span class="sc">+</span> clonal_type<span class="sc">:</span>s_score, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist.r <span class="ot">&lt;-</span> <span class="fu">glm</span>(n.prov <span class="sc">~</span> clonal_type <span class="sc">+</span> r_score <span class="sc">+</span> clonal_type<span class="sc">:</span>r_score, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a>查看并整理模型结果。</span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary-dist-2}</span></span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型结果</span></span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.dist.c)</span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.dist.s)</span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02.ias.dist.r)</span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom::tidy 提取并合并模型结果</span></span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist.c <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.dist.c) <span class="sc">%&gt;%</span></span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.dist.c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-454"><a href="#cb68-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist.s <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.dist.s) <span class="sc">%&gt;%</span></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.dist.s"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist.r <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit02.ias.dist.r) <span class="sc">%&gt;%</span></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"fit02.ias.dist.r"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a>results_fit02.ias.dist <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.dist.c,</span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.dist.s,</span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a>    results_fit02.ias.dist.r</span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-469"><a href="#cb68-469" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存结果</span></span>
<span id="cb68-470"><a href="#cb68-470" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(results_fit02.ias.dist, "./results02/results_fit02.ias.dist.csv")</span></span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_fit02.ias.dist)</span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 可视化</span></span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a>生成预测数据，并在散点图上绘制不同克隆类型的拟合曲线。</span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-dist-2}</span></span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义评分变量和类型</span></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a>score_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)</span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a>score_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">21</span>)</span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用map批量拟合模型并生成预测数据</span></span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a>fit02.ias.dist <span class="ot">&lt;-</span> <span class="fu">map</span>(score_types, <span class="cf">function</span>(var) {</span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"n.prov ~ clonal_type +"</span>, var, <span class="st">"+ clonal_type:"</span>, var))</span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(formula, <span class="at">data =</span> df02, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fit02.ias.dist) <span class="ot">&lt;-</span> score_types</span>
<span id="cb68-489"><a href="#cb68-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-490"><a href="#cb68-490" aria-hidden="true" tabindex="-1"></a>pred02_list <span class="ot">&lt;-</span> <span class="fu">map2</span>(score_types, fit02.ias.dist, <span class="cf">function</span>(var_name, model) {</span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a>  var_grid <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">list</span>(score_seq, <span class="fu">unique</span>(df02<span class="sc">$</span>clonal_type)), <span class="fu">c</span>(var_name, <span class="st">"clonal_type"</span>))</span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a>  new_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(expand.grid, var_grid)</span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>n.prov <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_type <span class="ot">&lt;-</span> var_name</span>
<span id="cb68-495"><a href="#cb68-495" aria-hidden="true" tabindex="-1"></a>  new_data<span class="sc">$</span>score_value <span class="ot">&lt;-</span> new_data[[var_name]]</span>
<span id="cb68-496"><a href="#cb68-496" aria-hidden="true" tabindex="-1"></a>  new_data[[var_name]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(new_data)</span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a>pred02_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pred02_list) <span class="sc">%&gt;%</span></span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(score_type, clonal_type, score_value) <span class="sc">%&gt;%</span> </span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score_type =</span> <span class="fu">factor</span>(score_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"c_score"</span>, <span class="st">"s_score"</span>, <span class="st">"r_score"</span>)))</span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a>plot.dist02 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df02_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov, <span class="at">color =</span> clonal_type)) <span class="sc">+</span></span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb68-507"><a href="#cb68-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred02_long, <span class="fu">aes</span>(<span class="at">x =</span> score_value, <span class="at">y =</span> n.prov), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-508"><a href="#cb68-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Score (%)"</span>, <span class="at">y =</span> <span class="st">"No. provinces"</span>) <span class="sc">+</span></span>
<span id="cb68-509"><a href="#cb68-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb68-510"><a href="#cb68-510" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"aboveground"</span> <span class="ot">=</span> <span class="st">"#E57373"</span>, <span class="st">"belowground"</span> <span class="ot">=</span> <span class="st">"#64B5F6"</span>),</span>
<span id="cb68-511"><a href="#cb68-511" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Clonal type:"</span>,</span>
<span id="cb68-512"><a href="#cb68-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Aboveground"</span>, <span class="st">"Belowground"</span>)</span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>score_type, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(score_labels)) <span class="sc">+</span></span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-518"><a href="#cb68-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-519"><a href="#cb68-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb68-524"><a href="#cb68-524" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-525"><a href="#cb68-525" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-531"><a href="#cb68-531" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot.dist02)</span>
<span id="cb68-532"><a href="#cb68-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存图像</span></span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot.dist02,</span></span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a><span class="co">#       filename = "./results02/plot.dist02.png",</span></span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 2400,</span></span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 1200,</span></span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a><span class="co">#       pointsize = 12,</span></span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a><span class="co">#       res = 300</span></span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3 汇总图</span></span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a>将关于克隆类型的入侵等级和入侵范围的图合并展示。</span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-summary-2}</span></span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总图</span></span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a>plot02 <span class="ot">&lt;-</span> plot.rank02 <span class="sc">+</span></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a>          plot.dist02 <span class="sc">+</span></span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-552"><a href="#cb68-552" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb68-553"><a href="#cb68-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-554"><a href="#cb68-554" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot02)</span>
<span id="cb68-555"><a href="#cb68-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存汇总图</span></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a><span class="co"># ggexport(plot02,</span></span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a><span class="co">#          filename = "./results02/plot02.png",</span></span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a><span class="co">#          width = 2400,</span></span>
<span id="cb68-560"><a href="#cb68-560" aria-hidden="true" tabindex="-1"></a><span class="co">#          height = 2400,</span></span>
<span id="cb68-561"><a href="#cb68-561" aria-hidden="true" tabindex="-1"></a><span class="co">#          pointsize = 12,</span></span>
<span id="cb68-562"><a href="#cb68-562" aria-hidden="true" tabindex="-1"></a><span class="co">#          res = 300</span></span>
<span id="cb68-563"><a href="#cb68-563" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb68-564"><a href="#cb68-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="csr和克隆性代码_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>